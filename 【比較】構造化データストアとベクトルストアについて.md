# AWS Bedrock: 構造化データストアとベクトルストアの比較

AWS Bedrockにおけるナレッジベースとエージェントの機能を活用する際、データの種類に応じて主に2つのアプローチが存在します。

## 1. ベクトルストア (Vector Store) - 非構造化データ向け

こちらが **Bedrock Knowledgebase** の中核をなす機能です。

-   **対象データ**: PDF, Word, HTML, テキストファイルなど、構造化されていないドキュメント。
-   **仕組み**:
    1.  S3バケットなどに格納されたドキュメントを、Bedrockが意味のある塊（チャンク）に自動で分割します。
    2.  埋め込みモデル（Embedding Model）を使い、各チャンクをベクトルデータに変換します。
    3.  変換されたベクトルデータを、Amazon OpenSearch ServerlessやPineconeなどのベクトルストアに保存・インデックス化します。
-   **主な用途**: **RAG (Retrieval Augmented Generation)**
    -   ユーザーからの質問（プロンプト）もベクトル化し、ベクトルストア内で関連性の高い情報を高速に検索します。
    -   検索で得られた情報をコンテキストとしてLLMに渡し、精度の高い回答を生成させます。
-   **構築プロセス**: ナレッジベースを構築する際は、データソース（S3）と、そのデータを格納するベクトルストアを選択することが前提となります。

---

## 2. 構造化データストア (Structured Data Store) - 構造化データ向け

こちらは **Agents for Amazon Bedrock** の機能と連携して実現します。ナレッジベースの直接的な機能ではありません。

-   **対象データ**: Redshift, RDS, Auroraなどのリレーショナルデータベースに格納された構造化データ。
-   **仕組み**: **Text-to-SQL**
    1.  ユーザーが自然言語で「先月の東京支店の売上は？」といった指示をエージェントに出します。
    2.  エージェントが指示を解釈し、LLMの能力を使ってデータベースで実行可能なSQLクエリを自動生成します。
    3.  Lambda関数などを介してSQLがデータベースで実行され、結果が返されます。
    4.  エージェントが結果を解釈し、自然言語でユーザーに回答します。
-   **主な用途**:
    -   SQLを知らないユーザーによるデータベースの対話的な操作。
    -   ビジネスインテリジェンス（BI）ツールのようなダッシュボード問い合わせの自動化。

## まとめ

| 観点           | ベクトルストア (Knowledgebase)                            | 構造化データストア (Agents)                                  |
| :------------- | :-------------------------------------------------------- | :----------------------------------------------------------- |
| **中心機能**   | Bedrock Knowledgebase                                     | Agents for Amazon Bedrock                                    |
| **データ形式** | 非構造化・半構造化データ（ドキュメントなど）              | 構造化データ（データベース）                                 |
| **技術**       | RAG（ベクトル検索）                                       | Text-to-SQL（自然言語からのSQL生成）                         |
| **目的**       | ドキュメントの内容に基づいた質疑応答                      | データベースに対する自然言語での問い合わせ、データ抽出       |

ナレッジベースの構築は「ベクトルストア」の利用が前提であり、構造化データとの連携は「エージェント」が担う、という役割分担になっています。
