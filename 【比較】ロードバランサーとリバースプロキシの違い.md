# 【比較】ロードバランサーとリバースプロキシの違い

Webシステムの可用性やパフォーマンスを向上させるために重要な役割を果たす「ロードバランサー」と「リバースプロキシ」。この2つは、クライアントとサーバーの間に配置されるという点で共通しており、しばしば同じソフトウェア（例: Nginx, HAProxy）が両方の機能を提供するため混同されがちです。しかし、その**主目的**には明確な違いがあります。

## 概要

| 項目 | ロードバランサー (Load Balancer) | リバースプロキシ (Reverse Proxy) |
| --- | --- | --- |
| **主目的** | **負荷分散** | **リクエストの中継・集約** |
| **役割** | 複数のサーバーにトラフィックを振り分ける | 特定のサーバー群の唯一の窓口となる |
| **主な関心事** | サーバーの稼働状況、応答時間、負荷 | URLのパス、リクエスト内容、セキュリティ |
| **主な機能** | 負荷分散、ヘルスチェック、SSLアクセラレーション | **リクエストルーティング**、**SSL終端**、**キャッシュ**、セキュリティ対策 |
| **構成** | 1台のロードバランサーが複数のサーバーを束ねる | 1台のリバースプロキシが1つ以上のサーバーの代理となる |
| **例えるなら** | 人気飲食店の「**受付・案内係**」 | 特定の会社の「**総合受付**」や「**代表電話**」 |

一言で言うと、**ロードバランサーは「複数のサーバーに仕事をうまく割り振る」のが専門**であり、**リバースプロキシは「サーバーの代わりにリクエストを受け取り、適切な場所に繋ぐ」のが専門**です。リバースプロキシが持つ機能の一つとして、負荷分散機能が含まれることもあります。

---

## 各技術の詳細

### 1. ロードバランサー (Load Balancer)

ロードバランサーの第一の目的は、その名の通り「負荷（Load）」を「分散（Balance）」させることです。Webサイトへのアクセスが集中すると、1台のサーバーだけでは処理しきれなくなり、レスポンスが遅延したり、最悪の場合はサーバーがダウンしたりします。これを防ぐため、ロードバランサーは受け取ったリクエストを、複数のバックエンドサーバーに効率的に振り分けます。

#### 主な機能と役割

- **負荷分散**: ラウンドロビン、最小コネクション数、IPハッシュなど、様々なアルゴリズムを用いて、各サーバーに均等（または最適）にリクエストを分配します。
- **ヘルスチェック**: 定期的にバックエンドサーバーの稼働状況を監視します。もしサーバーが応答しない、あるいは異常な応答を返した場合、そのサーバーを振り分け対象から一時的に外し、正常なサーバーにのみリクエストを送るようにします（**冗長化・可用性の向上**）。
- **SSLアクセラレーション**: SSL/TLSの暗号化・復号処理をロードバランサーが肩代わりし、バックエンドサーバーの負荷を軽減します。
- **セッション維持（パーシステンス）**: 特定のユーザーからのリクエストを、常に同じサーバーに送るように制御します。ショッピングカート機能などで必要になります。

**ロードバランサーは、システムのスケールアウト（サーバー増設による性能向上）と可用性の確保に不可欠な技術です。**

### 2. リバースプロキシ (Reverse Proxy)

リバースプロキシは、不特定多数のクライアントからのリクエストを一旦受け取り、それをバックエンドの適切なサーバーに**中継**します。クライアントからは、リバースプロキシ自体がコンテンツを提供しているように見え、背後にある実際のサーバーの存在は隠蔽されます。

#### 主な機能と役割

- **リクエストルーティング**: URLのパス（例: `/api/`, `/images/`）などに応じて、リクエストを異なるサーバー（APIサーバー、画像サーバーなど）に振り分けます。マイクロサービスアーキテクチャで重要な役割を果たします。
- **SSL終端**: クライアントとの通信を暗号化（HTTPS）し、リバースプロキシとバックエンドサーバー間は暗号化しない（HTTP）構成にすることで、証明書管理を一元化し、バックエンドサーバーの負荷を軽減します。
- **キャッシュ**: 画像やCSSなどの静的コンテンツや、頻繁にアクセスされる動的コンテンツを一時的に保存（キャッシュ）し、バックエンドサーバーに問い合わせることなく高速に応答します。
- **セキュリティの向上**: バックエンドサーバーのIPアドレスや構成を外部から隠蔽し、不正なリクエストをフィルタリングするWAF（Web Application Firewall）のような役割を担うことで、セキュリティを強化します。
- **圧縮**: レスポンスボディを圧縮して、クライアントへの転送量を削減します。

**リバースプロキシは、システムの構成を柔軟にし、パフォーマンスとセキュリティを向上させる多機能な中継役です。**

## 関係性と使い分け

- ロードバランサーは**負荷分散が主目的**。
- リバースプロキシは**リクエストの中継が主目的**であり、その過程でキャッシュやURLルーティングなど多くの付加機能を提供します。

実際には、**多くのロードバランサーはリバースプロキシとして機能し、多くのリバースプロキシは負荷分散機能を持っています。**

- **シンプルなWebサイトで、サーバー1台の負荷を軽減したい** → **リバースプロキシ**を導入し、キャッシュを活用する。
- **アクセスが増えてきたので、Webサーバーを複数台に増やして可用性を高めたい** → **ロードバランサー**を導入し、トラフィックを分散させる。
- **複数のサービス（API、Web、画像配信など）を異なるサーバーで運用している** → **リバースプロキシ**を導入し、URLパスに基づいて各サーバーにルーティングする。

現代のWebシステムでは、これらを組み合わせて利用するのが一般的です。例えば、外部からのリクエストをまずロードバランサーで受け、それを複数のリバースプロキシサーバーに分散し、各リバースプロキシがさらにバックエンドのアプリケーションサーバーにリクエストをルーティングする、といった多段構成も珍しくありません。 