# 【比較】RESTとGraphQLの違い

Web API（アプリケーション間でデータをやり取りするためのインターフェース）の設計において、長らく主流であった「REST」と、近年Facebook（現Meta）によって開発され、急速に採用が広がっている「GraphQL」。この2つは、APIとのコミュニケーション方法において、根本的なアプローチの違いがあります。

## 概要

| 項目 | REST (Representational State Transfer) | GraphQL (Graph Query Language) |
| --- | --- | --- |
| **アーキテクチャ** | **アーキテクチャスタイル**（設計思想） | **クエリ言語**およびその実行環境 |
| **エンドポイント** | 複数（リソースごとにURLが存在） | 単一（通常 `/graphql` のみ） |
| **データ取得** | サーバー側が定義した固定のデータ構造 | **クライアント側が必要なデータを指定** |
| **課題** | オーバーフェッチ／アンダーフェッチが発生しやすい | 学習コスト、複雑なクエリによる性能問題 |
| **HTTPメソッド** | GET, POST, PUT, DELETEなどを使い分ける | 主にPOSTのみを使用 |
| **型システム** | なし（OpenAPIなどで仕様を定義） | あり（スキーマ定義言語で厳密に型を定義） |
| **例えるなら** | **レストランのセットメニュー** | **アラカルト（単品注文）** |

一言で言うと、**RESTは「リソース（情報）ごとに用意された窓口（URL）を叩く」** アーキテクチャであり、**GraphQLは「一つの大きな窓口に必要なものだけを細かく注文する」** ための言語です。

---

## 各アプローチの詳細

### 1. REST (Representational State Transfer)

RESTは、Webの原則（HTTPメソッド、ステートレス性など）に基づいてシステムを設計するためのアーキテクチャスタイルです。「リソース」という概念が中心にあり、すべての情報（ユーザー、商品など）は一意なURL（エンドポイント）で識別されます。

#### 主な特徴

- **リソース指向**: `/users` や `/users/1` のように、URLが操作対象のリソースを表します。
- **HTTPメソッドの活用**: リソースに対する操作をHTTPメソッドで表現します。
    - `GET`: リソースの取得
    - `POST`: リソースの新規作成
    - `PUT`/`PATCH`: リソースの更新
    - `DELETE`: リソースの削除
- **ステートレス**: サーバーはクライアントの状態を保持せず、各リクエストは完結している必要があります。
- **オーバーフェッチとアンダーフェッチ**:
    - **オーバーフェッチ**: エンドポイントが固定のデータ構造を返すため、クライアントに不要なデータまで含まれてしまう問題。例えば、ユーザー名だけ欲しいのに、`/users/1` を叩くと住所や電話番号まで返ってくるケース。
    - **アンダーフェッチ**: 欲しい情報が複数のリソースにまたがっている場合、何度もAPIを呼び出す必要がある問題。例えば、ユーザー情報とその投稿一覧を取得するために、`/users/1` と `/users/1/posts` の2回のリクエストが必要になるケース。

**RESTはシンプルで理解しやすく、Webの標準技術に基づいているため、多くのWebサービスで採用されています。**

### 2. GraphQL (Graph Query Language)

GraphQLは、APIのためのクエリ言語であり、クライアントが必要なデータの構造をリクエストに記述できるのが最大の特徴です。これにより、RESTが抱えていたオーバーフェッチやアンダーフェッチの問題を解決します。

#### 主な特徴

- **単一エンドポイント**: 通常、すべてのリクエストは単一のURL（例: `/graphql`）にPOSTメソッドで送信されます。
- **クライアント主導のデータ取得**: クライアントは「クエリ」と呼ばれる要求を送信し、欲しいデータとその構造を自由に指定できます。
    ```graphql
    // ユーザーID:1のユーザー名と、そのユーザーの投稿のタイトルだけを取得するクエリ
    query {
      user(id: "1") {
        name
        posts {
          title
        }
      }
    }
    ```
    このクエリにより、1回のリクエストで必要なデータだけを過不足なく取得できます。
- **厳密な型システム**: サーバー側で「スキーマ」を定義し、APIで扱えるデータの型や関係性を厳密に記述します。これにより、APIの仕様が明確になり、開発ツールによる支援（入力補完など）も受けやすくなります。
- **操作の分類**:
    - `Query`: データの取得（RESTのGETに相当）
    - `Mutation`: データの作成・更新・削除（POST, PUT, DELETEに相当）
    - `Subscription`: リアルタイムなデータ更新の購読

**GraphQLは、特に複数のデータソースを扱う場合や、多様なクライアント（Web、モバイルアプリなど）がそれぞれ異なるデータ要件を持つ場合に強力な柔軟性を発揮します。**

## どちらを選ぶべきか？

- **RESTを選ぶケース**:
    - APIがシンプルで、リソースの構造が固定的な場合。
    - HTTPキャッシングなど、Webの標準的な仕組みを最大限に活用したい場合。
    - プロジェクトメンバーがRESTに慣れ親しんでいる場合。

- **GraphQLを選ぶケース**:
    - クライアントごとに必要なデータが大きく異なる複雑なアプリケーション。
    - モバイルアプリなど、通信量を最小限に抑えたい場合。
    - 複数のマイクロサービスやデータベースからデータを集約するAPIを構築する場合。

両者はトレードオフの関係にあり、プロジェクトの要件やチームのスキルセットに応じて最適なものを選択することが重要です。RESTfulなAPIの前にGraphQLサーバーを配置し、両者を併用するアーキテクチャも存在します。 